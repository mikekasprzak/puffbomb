// - ------------------------------------------------------------------------------------------ - //
// PairRect2D //
// - ------------------------------------------------------------------------------------------ - //
#ifndef __Geometry_PairRect2D_H__
#define __Geometry_PairRect2D_H__
// - ------------------------------------------------------------------------------------------ - //

// - ------------------------------------------------------------------------------------------ - //
#include <Geometry/Real.h>
#include <Geometry/Vector.h>
// - ------------------------------------------------------------------------------------------ - //

class PairRect2D {
public:
	// - -------------------------------------------------------------------------------------- - //
	Vector2D _P1;
	Vector2D _P2;
	// - -------------------------------------------------------------------------------------- - //
public:
	// - -------------------------------------------------------------------------------------- - //
	PairRect2D() {
	}
	// - -------------------------------------------------------------------------------------- - //

	// - -------------------------------------------------------------------------------------- - //
	// Normal Creation (RectXD style (x,y,w,h)) //
	// - -------------------------------------------------------------------------------------- - //
	inline PairRect2D( const Real& _x, const Real& _y, const Real& _w, const Real& _h ) :
		_P1( _x, _y ),
		_P2( _x + _w, _y + _h )
	{
	}
	// - -------------------------------------------------------------------------------------- - //
	inline PairRect2D( const Vector2D& _Vec1, const Vector2D& _Vec2 ) :
		_P1( _Vec1 ),
		_P2( _Vec1 + _Vec2 )
	{
	}
	// - -------------------------------------------------------------------------------------- - //

	// - -------------------------------------------------------------------------------------- - //
	// Pair Creation (P1, P2) //
	// - -------------------------------------------------------------------------------------- - //
	inline PairRect2D( const bool&, const Vector2D& _Vec1, const Vector2D& _Vec2 ) :
		_P1( _Vec1.x.Min( _Vec2.x ), _Vec1.y.Min( _Vec2.y ) ),
		_P2( _Vec1.x.Max( _Vec2.x ), _Vec1.y.Max( _Vec2.y ) )
	{
	}
	// - -------------------------------------------------------------------------------------- - //
	inline PairRect2D( const bool&, const bool&, const Vector2D& _Vec1, const Vector2D& _Vec2 ) :
		_P1( _Vec1 ),
		_P2( _Vec2 )
	{
	}
	// - -------------------------------------------------------------------------------------- - //


	// - -------------------------------------------------------------------------------------- - //
	// Radius Creation (Center, HalfShape) //
	// - -------------------------------------------------------------------------------------- - //
	inline PairRect2D( const bool&, const bool&, const bool&, const Vector2D& _VecCenter, const Vector2D& _VecShape ) :
		_P1( _VecCenter - _VecShape ),
		_P2( _VecCenter + _VecShape )
	{
	}
	// - -------------------------------------------------------------------------------------- - //

public:
	// - -------------------------------------------------------------------------------------- - //
	// Creation as a Pair //
	// - -------------------------------------------------------------------------------------- - //
	inline static const PairRect2D Pair( const Real& _x1, const Real& _y1, const Real& _x2, const Real& _y2 ) {
		return PairRect2D( true, Vector2D( _x1, _y1 ), Vector2D( _x2, _y2 ) );
	}
	// - -------------------------------------------------------------------------------------- - //
	inline static const PairRect2D Pair( const Vector2D& _Vec1, const Vector2D& _Vec2 ) {
		return PairRect2D( true, _Vec1, _Vec2 );
	}
	// - -------------------------------------------------------------------------------------- - //
	// Optimized Pair Creation (both points must be in the correct space, no min/max'ing done) //
	// - -------------------------------------------------------------------------------------- - //
	inline static const PairRect2D _Pair( const Vector2D& _Vec1, const Vector2D& _Vec2 ) {
		return PairRect2D( true, true, _Vec1, _Vec2 );
	}
	// - -------------------------------------------------------------------------------------- - //	

	// - -------------------------------------------------------------------------------------- - //
	// Creation as a Radius //
	// - -------------------------------------------------------------------------------------- - //
	inline static const PairRect2D Radius( const Real& _x1, const Real& _y1, const Real& _x2, const Real& _y2 ) {
		return PairRect2D( true, true, true, Vector2D( _x1, _y1 ), Vector2D( _x2, _y2 ) );
	}
	// - -------------------------------------------------------------------------------------- - //
	inline static const PairRect2D Radius( const Vector2D& _Vec1, const Vector2D& _Vec2 ) {
		return PairRect2D( true, true, true, _Vec1, _Vec2 );
	}
	// - -------------------------------------------------------------------------------------- - //
	
public:
	// - -------------------------------------------------------------------------------------- - //
	inline const Vector2D& P1() const {
		return _P1;
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const Vector2D& P2() const {
		return _P2;
	}
	// - -------------------------------------------------------------------------------------- - //

	// - -------------------------------------------------------------------------------------- - //
	inline const Vector2D Center() const {
		return P1() + HalfShape();
	}
	// - -------------------------------------------------------------------------------------- - //

	// - -------------------------------------------------------------------------------------- - //
	inline const Real Width() const {
		return P2().x - P1().x;
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const Real HalfWidth() const {
		return Width() * Real::Half;
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const Real Height() const {
		return P2().y - P1().y;
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const Real HalfHeight() const {
		return Height() * Real::Half;
	}
	// - -------------------------------------------------------------------------------------- - //
	
	// - -------------------------------------------------------------------------------------- - //
	inline const Vector2D Shape() const {
		return P2() - P1();
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const Vector2D HalfShape() const {
		return Shape() * Real::Half;
	}
	// - -------------------------------------------------------------------------------------- - //
public:	
	// - -------------------------------------------------------------------------------------- - //
	inline const Real Area() const {
		return Width() * Height();
	}
	// - -------------------------------------------------------------------------------------- - //

public:	
	// - -------------------------------------------------------------------------------------- - //
	// Test for intersection between rectangles //
	inline const bool operator == ( const PairRect2D& Vs ) const;
	// - -------------------------------------------------------------------------------------- - //
	inline const bool operator != ( const PairRect2D& Vs ) const {
		return !(*this == Vs);
	}
	// - -------------------------------------------------------------------------------------- - //
	inline const bool operator == ( const Vector2D& Vs ) const;
	// - -------------------------------------------------------------------------------------- - //
	// Rectangle Difference //
	inline const PairRect2D operator - ( const PairRect2D& Vs ) const {
		return Pair(
			Vector2D( P1().x.Max( Vs.P1().x ), P1().y.Max( Vs.P1().y ) ),
			Vector2D( P2().x.Min( Vs.P2().x ), P2().y.Min( Vs.P2().y ) )
			);
	}
	// - -------------------------------------------------------------------------------------- - //
	// Rectangle Union //
	inline const PairRect2D operator + ( const PairRect2D& Vs ) const {
		return Pair(
			Vector2D( P1().x.Min( Vs.P1().x ), P1().y.Min( Vs.P1().y ) ),
			Vector2D( P2().x.Max( Vs.P2().x ), P2().y.Max( Vs.P2().y ) )
			);
	}
	// - -------------------------------------------------------------------------------------- - //
	inline Vector2D ClosestPoint( const Vector2D& v ) const {
		Vector2D Point;
	
		if ( v.x < P1().x )
			Point.x = P1().x;
		else if ( v.x > P2().x )
			Point.x = P2().x;
		else
			Point.x = v.x;
	
		if ( v.y < P1().y )
			Point.y = P1().y;
		else if ( v.y > P2().y )
			Point.y = P2().y;
		else
			Point.y = v.y;
	
		return Point;
	}
	// - -------------------------------------------------------------------------------------- - //
public:
	inline const class Rect2D ToRect() const;
	inline const class RadiusRect2D ToRadiusRect() const;
	inline const PairRect2D& ToPairRect() const {
		return *this;
	}
};

// - ------------------------------------------------------------------------------------------ - //
#endif // __Geometry_PairRect2D_H__ //
// - ------------------------------------------------------------------------------------------ - //
